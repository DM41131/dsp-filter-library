class t{static add(t,e){return{re:t.re+e.re,im:t.im+e.im}}static sub(t,e){return{re:t.re-e.re,im:t.im-e.im}}static mul(t,e){return{re:t.re*e.re-t.im*e.im,im:t.re*e.im+t.im*e.re}}static div(t,e){const r=e.re*e.re+e.im*e.im||1e-300;return{re:(t.re*e.re+t.im*e.im)/r,im:(t.im*e.re-t.re*e.im)/r}}static abs(t){return Math.hypot(t.re,t.im)}static conj(t){return{re:t.re,im:-t.im}}}const e=2*Math.PI;function r(t,e,r){const s=new Array(r),a=(e-t)/(r-1);for(let e=0;e<r;e++)s[e]=t+e*a;return s}function s(t){const r=[...t];for(let t=0;t<2;t++)for(let t=1;t<r.length;t++){const s=r[t]-r[t-1];s>Math.PI&&(r[t]-=e),s<-Math.PI&&(r[t]+=e)}return r}class a{static evalRealAsc(e,r){let s={re:e[0],im:0};for(let a=1;a<e.length;a++)s=t.add(t.mul(s,r),{re:e[a],im:0});return s}}function n(e,r){const s=e.length-1;let a={re:1,im:0},n={re:0,im:0};for(let i=1;i<=s;i++)n=t.add(t.mul(n,r),a),a=t.add(t.mul(a,r),{re:e[i],im:0});return{p:a,dp:n}}class i{static aberthMonic(e){let r=0;for(;r<e.length-1&&Math.abs(e[r])<1e-18;)r++;let s=e.slice(r);const a=s.length-1;if(a<=0)return[];const i=s[0];s=s.map(t=>t/i);let o=0;for(let t=1;t<s.length;t++)o=Math.max(o,Math.abs(s[t]));const c=Math.max(.5,Math.min(1.5,1+o)),h=new Array(a);for(let t=0;t<a;t++){const e=2*Math.PI*(t+.5)/a,r=1+.001*(t%2?1:-1);h[t]={re:c*r*Math.cos(e),im:c*r*Math.sin(e)}}const l=1e-14;for(let e=0;e<200;e++){let e=!1;for(let r=0;r<a;r++){const i=h[r],{p:o,dp:c}=n(s,i);let m={re:0,im:0};for(let e=0;e<a;e++)if(e!==r){let r=t.sub(i,h[e]);const s=r.re*r.re+r.im*r.im;s<1e-28&&(r={re:r.re+l,im:r.im});const a={re:r.re/(s||1e-300),im:-r.im/(s||1e-300)};m=t.add(m,a)}const u=t.sub(c,t.mul(o,m)),M=t.div(o,u),f=t.sub(i,M);Math.hypot(f.re-i.re,f.im-i.im)>1e-12&&(e=!0),h[r]=f}if(!e)break}return h}static dkScaled(e){let r=0;for(;r<e.length-1&&Math.abs(e[r])<1e-18;)r++;const s=e.slice(r),n=s.length-1;if(n<=0)return[];const i=s[0],o=s.map(t=>t/i),c=[];for(const e of[.8,1.1,1.5]){const r=new Array(n);for(let t=0;t<n;t++){const s=2*Math.PI*(t+1)/n;r[t]={re:e*Math.cos(s),im:e*Math.sin(s)}}for(let e=0;e<200;e++){let e=!1;for(let s=0;s<n;s++){let i={re:1,im:0};for(let e=0;e<n;e++)s!==e&&(i=t.mul(i,t.sub(r[s],r[e])));const c=a.evalRealAsc(o,r[s]),h=t.div(c,i),l=t.sub(r[s],h);Math.hypot(l.re-r[s].re,l.im-r[s].im)>1e-12&&(e=!0),r[s]=l}if(!e)break}c.push(...r)}return c}}class o{static butter(t){const e=[];for(let r=1;r<=t;r++){const s=(2*r-1)*Math.PI/(2*t);e.push({re:-Math.sin(s),im:Math.cos(s)})}return{poles:e,zeros:[]}}static cheby1(t,e){const r=Math.sqrt(Math.pow(10,e/10)-1),s=Math.asinh(1/r)/t,a=[];for(let e=1;e<=t;e++){const r=(2*e-1)*Math.PI/(2*t);a.push({re:-Math.sinh(s)*Math.sin(r),im:Math.cosh(s)*Math.cos(r)})}return{poles:a,zeros:[]}}static cheby2(t,e){const r=1/Math.sqrt(Math.pow(10,e/10)-1),s=Math.asinh(1/r)/t,a=[],n=[];for(let e=1;e<=t;e++){const r=(2*e-1)*Math.PI/(2*t);a.push({re:-Math.sinh(s)*Math.sin(r),im:Math.cosh(s)*Math.cos(r)})}const i=Math.floor(t/2);for(let e=1;e<=i;e++){const r=(2*e-1)*Math.PI/(2*t),s=1/Math.cos(r);n.push({re:0,im:s},{re:0,im:-s})}return{poles:a,zeros:n}}static ellipHybrid(t,e,r){const s=o.cheby1(t,e),a=o.cheby2(t,r);return{poles:s.poles,zeros:a.zeros}}static linkwitzRiley(t){const e=t%2==0?t:t+1,r=o.butter(e/2),s=[];return r.poles.forEach(t=>{s.push(t,{re:t.re,im:t.im})}),{poles:s,zeros:[],enforcedOrder:e}}static bessel(t){const e=Math.min(t,12),r=new Array(e+1).fill(0);r[0]=1;for(let t=1;t<=e;t++)r[t]=r[t-1]*((e+t)*(e-t+1))/(2*t);return{poles:(()=>{const t=r.length-1,e=new Array(t);for(let r=0;r<t;r++){const s=2*Math.PI*(r+1)/t;e[r]={re:1.5*Math.cos(s),im:1.5*Math.sin(s)}}for(let s=0;s<200;s++){let s=!1;for(let n=0;n<t;n++){let i={re:1,im:0};for(let r=0;r<t;r++)n!==r&&(i={re:i.re*(e[n].re-e[r].re)-i.im*(e[n].im-e[r].im),im:i.re*(e[n].im-e[r].im)+i.im*(e[n].re-e[r].re)});const o=a.evalRealAsc(r,e[n]),c={re:o.re/(i.re||1e-300),im:o.im/(i.re||1e-300)},h={re:e[n].re-c.re,im:e[n].im-c.im};Math.hypot(h.re-e[n].re,h.im-e[n].im)>1e-12&&(s=!0),e[n]=h}if(!s)break}return e.filter(t=>t.re<0||Math.abs(t.re)<1e-12)})(),zeros:[]}}}class c{static prewarp(t,e){return 2*e*Math.tan(Math.PI*t/e)}static sToZ(e,r){const s={re:2*r+e.re,im:e.im},a={re:2*r-e.re,im:-e.im};return t.div(s,a)}static quad(e,r,s){const a=t.mul(r,r),n=t.mul({re:4,im:0},t.mul(e,s)),i=function(t){const e=t.re,r=t.im,s=Math.hypot(e,r),a=Math.sqrt((s+Math.abs(e))/2);if(e>=0)return{re:a,im:r/(2*(a||1e-300))};const n=(r>=0?1:-1)*a;return{re:r/(2*(n||1e-300)),im:n}}({re:a.re-n.re,im:a.im-n.im}),o={re:-r.re,im:-r.im},c=t.mul({re:2,im:0},e);return[t.div(t.add(o,i),c),t.div(t.sub(o,i),c)]}}function h(t){const e=new Array(t.length).fill(!1),r=[];for(let s=0;s<t.length;s++){if(e[s])continue;const a=t[s];let n=!1;for(let i=s+1;i<t.length;i++)if(!e[i]){const o=t[i];if(Math.abs(a.re-o.re)<1e-10&&Math.abs(a.im+o.im)<1e-10){r.push([a,o]),e[s]=e[i]=!0,n=!0;break}}n||(r.push([a]),e[s]=!0)}return r}class l{static fromZPK(e,r,s=1){for(;e.length<r.length;)e.push({re:-1,im:0});const a=h(e),n=h(r),i=[];let o=0,c=0;for(;c<n.length;){const e=n[c++],r=o<a.length?a[o++]:[{re:-1,im:0},{re:-1,im:0}],s=e[0],h=e[1]||{re:0,im:0},l=r[0],m=r[1]||{re:-1,im:0},u={re:l.re+m.re,im:l.im+m.im},M=t.mul(l,m),f={re:s.re+h.re,im:s.im+h.im},p=t.mul(s,h),b=[1,-u.re,M.re],g=[1,-f.re,p.re];i.push({b:b,a:g})}return i.length&&(i[0].b=[i[0].b[0]*s,i[0].b[1]*s,i[0].b[2]*s]),i}}class m{static H_w_IIR(e,r){const s=Math.cos(r),a=-Math.sin(r),n=Math.cos(2*r),i=-Math.sin(2*r);let o={re:1,im:0};for(const r of e){const[e,c,h]=r.b,[,l,m]=r.a,u={re:e+c*s+h*n,im:c*a+h*i},M={re:1+l*s+m*n,im:l*a+m*i},f=M.re*M.re+M.im*M.im,p={re:(u.re*M.re+u.im*M.im)/f,im:(u.im*M.re-u.re*M.im)/f};o=t.mul(o,p)}return o}static H_w_FIR(t,e){let r=0,s=0;for(let a=0;a<t.length;a++)r+=t[a]*Math.cos(e*a),s-=t[a]*Math.sin(e*a);return{re:r,im:s}}static magDbFromH(e){return 20*Math.log10(Math.max(1e-16,t.abs(e)))}static unwrapToDeg(t){return s(t).map(t=>180*t/Math.PI)}static groupDelay(t,e){const r=e.length,s=new Array(r).fill(0);if(r>=3){for(let a=1;a<r-1;a++){const r=t[a+1]-t[a-1],n=e[a+1]-e[a-1];s[a]=-r/(n||1e-12)}s[0]=s[1],s[r-1]=s[r-2]}return s}static phaseDelay(t,e){const r=new Array(e.length).fill(0);for(let s=0;s<e.length;s++)r[s]=0===e[s]?NaN:-t[s]/e[s];let s=r.find(t=>Number.isFinite(t));Number.isFinite(s)||(s=0);for(let t=0;t<r.length&&!Number.isFinite(r[t]);t++)r[t]=s;for(let t=1;t<r.length;t++)Number.isFinite(r[t])||(r[t]=r[t-1]);return r}}class u{static rect(t){return Array.from({length:t},()=>1)}static rectangle(t){return u.rect(t)}static hann(t){return Array.from({length:t},(e,r)=>.5-.5*Math.cos(2*Math.PI*r/(t-1)))}static hamming(t){return Array.from({length:t},(e,r)=>.54-.46*Math.cos(2*Math.PI*r/(t-1)))}static blackman(t){return Array.from({length:t},(e,r)=>.42-.5*Math.cos(2*Math.PI*r/(t-1))+.08*Math.cos(4*Math.PI*r/(t-1)))}static blackmanHarris(t){return Array.from({length:t},(e,r)=>.35875-.48829*Math.cos(2*Math.PI*r/(t-1))+.14128*Math.cos(4*Math.PI*r/(t-1))-.01168*Math.cos(6*Math.PI*r/(t-1)))}static blackmanNuttall(t){return Array.from({length:t},(e,r)=>.3635819-.4891775*Math.cos(2*Math.PI*r/(t-1))+.1365995*Math.cos(4*Math.PI*r/(t-1))-.0106411*Math.cos(6*Math.PI*r/(t-1)))}static kaiser(t,e=8.6){const r=M(e),s=t-1;return Array.from({length:t},(t,a)=>{const n=2*a/s-1;return M(e*Math.sqrt(1-n*n))/r})}static tukey(t,e=.5){const r=t-1;return Array.from({length:t},(t,s)=>{const a=s/r;return e<=0?1:e>=1?.5*(1-Math.cos(2*Math.PI*a)):a<e/2?.5*(1+Math.cos(Math.PI*(2*a/e-1))):a<=1-e/2?1:.5*(1+Math.cos(Math.PI*(2*a/e-2/e+1)))})}static gauss(t,e=.4){const r=(t-1)/2;return Array.from({length:t},(t,s)=>{const a=(s-r)/(e*r);return Math.exp(-.5*a*a)})}static bartlett(t){const e=t-1;return Array.from({length:t},(t,r)=>1-Math.abs((r-e/2)/(e/2)))}static bartlettHann(t){const e=t-1;return Array.from({length:t},(t,r)=>{const s=r/e;return.62-.48*Math.abs(s-.5)-.38*Math.cos(2*Math.PI*s)})}static cosine(t){const e=t-1;return Array.from({length:t},(t,r)=>Math.sin(Math.PI*r/e))}static lanczos(t){const e=(t-1)/2;return Array.from({length:t},(t,r)=>{return 0===(s=(r-e)/e)?1:Math.sin(Math.PI*s)/(Math.PI*s);var s})}static bohman(t){const e=(t-1)/2;return Array.from({length:t},(t,r)=>{const s=Math.abs(r-e)/e;return s<=1?(1-s)*Math.cos(Math.PI*s)+1/Math.PI*Math.sin(Math.PI*s):0})}static flatTop(t){const e=t-1;return Array.from({length:t},(t,r)=>1-1.93*Math.cos(2*Math.PI*r/e)+1.29*Math.cos(4*Math.PI*r/e)-.388*Math.cos(6*Math.PI*r/e)+.028*Math.cos(8*Math.PI*r/e))}static nuttall(t){return Array.from({length:t},(e,r)=>.355768-.487396*Math.cos(2*Math.PI*r/(t-1))+.144232*Math.cos(4*Math.PI*r/(t-1))-.012604*Math.cos(6*Math.PI*r/(t-1)))}static parzen(t){const e=(t-1)/2;return Array.from({length:t},(t,r)=>{const s=Math.abs(r-e)/e;return s<=.5?1-6*s*s*(1-s):2*Math.pow(1-s,3)})}static welch(t){const e=t-1;return Array.from({length:t},(t,r)=>1-Math.pow((r-e/2)/(e/2),2))}static triangular(t){const e=t-1;return Array.from({length:t},(t,r)=>1-Math.abs((2*r-e)/e))}static poisson(t,e=2){const r=(t-1)/2;return Array.from({length:t},(t,s)=>Math.exp(-e*Math.abs(s-r)/r))}static hanning(t){return u.hann(t)}static vonHann(t){return u.hann(t)}static nuttallBlackmanHarris(t){return u.blackmanNuttall(t)}static exactBlackman(t){return Array.from({length:t},(e,r)=>.42659-.49656*Math.cos(2*Math.PI*r/(t-1))+.076849*Math.cos(4*Math.PI*r/(t-1)))}static dolphChebyshev(t,e=50){const r=t-1,s=Math.cosh(Math.acosh(Math.pow(10,e/20))/r),a=(t,e)=>Math.abs(e)<=1?Math.cos(t*Math.acos(e)):Math.cosh(t*Math.acosh(e)),n=new Array(t);for(let e=0;e<t;e++){let i=0;for(let n=0;n<t;n++){i+=a(r,s*Math.cos(Math.PI*n/t))*Math.cos(2*Math.PI*e*n/t)}n[e]=i/t}const i=Math.max(...n);return n.map(t=>t/i)}static taylor(t,e=4,r=-30){const s=(t-1)/2,a=Math.acosh(Math.pow(10,-r/20))/Math.PI;return Array.from({length:t},(t,r)=>{const n=(r-s)/s;let i=1;for(let t=1;t<e;t++){i+=2*Math.sqrt(1-t/(a*a+(t-.5)*(t-.5)))*Math.cos(2*Math.PI*t*n)}return i/(2*e-1)})}static gaussian(t,e=.4){return u.gauss(t,e)}static raisedCosine(t,e=.5){return u.tukey(t,e)}static byName(t,e,r={}){const{beta:s=8.6,alpha:a=.5,sigma:n=.4,nbar:i=4,sll:o=-30}=r||{};switch(t){case"hann":case"hanning":case"vonHann":return u.hann(e);case"hamming":default:return u.hamming(e);case"blackman":return u.blackman(e);case"blackmanHarris":return u.blackmanHarris(e);case"blackmanNuttall":case"nuttallBlackmanHarris":return u.blackmanNuttall(e);case"nuttall":return u.nuttall(e);case"exactBlackman":return u.exactBlackman(e);case"rectangle":case"rect":return u.rect(e);case"bartlett":return u.bartlett(e);case"bartlettHann":return u.bartlettHann(e);case"cosine":return u.cosine(e);case"lanczos":return u.lanczos(e);case"bohman":return u.bohman(e);case"gauss":case"gaussian":return u.gauss(e,n);case"tukey":case"raisedCosine":return u.tukey(e,a);case"kaiser":return u.kaiser(e,s);case"flatTop":case"flattop":return u.flatTop(e);case"parzen":return u.parzen(e);case"welch":return u.welch(e);case"triangular":return u.triangular(e);case"poisson":return u.poisson(e,a);case"dolphChebyshev":return u.dolphChebyshev(e,a);case"taylor":return u.taylor(e,i,o)}}}const M=t=>{const e=Math.abs(t);if(e<3.75){const e=t/3.75,r=e*e;return 1+r*(3.5156229+r*(3.0899424+r*(1.2067492+r*(.2659732+r*(.0360768+.0045813*r)))))}{const t=3.75/e;return Math.exp(e)/Math.sqrt(e)*(.39894228+t*(.01328592+t*(.00225319+t*(t*(.00916281+t*(t*(.02635537+t*(.00392377*t-.01647633))-.02057706))-.00157565))))}};function f(t,e,r=1e-9){for(const s of t)if(Math.hypot(s.re-e.re,s.im-e.im)<r)return!1;return t.push(e),!0}class p{static fromTapsRobust(t){const e=t.length-1,r=new Array(t.length);for(let s=0;s<t.length;s++)r[s]=t[e-s];let s=0;for(;s<r.length-1&&Math.abs(r[s])<1e-18;)s++;const a=r.slice(s).length-1;if(a<=0)return[];const n=[];try{for(const t of i.aberthMonic(r))Number.isFinite(t.re)&&Number.isFinite(t.im)&&f(n,t)}catch{}try{for(const t of i.dkScaled(r))Number.isFinite(t.re)&&Number.isFinite(t.im)&&f(n,t)}catch{}if(n.length<a){const e=function(t,e){const r=8192,s=[],a=new Float64Array(r+1);for(let e=0;e<=r;e++){const s=Math.PI*e/r,n=m.H_w_FIR(t,s);a[e]=Math.hypot(n.re,n.im)}for(let t=1;t<r;t++)if(a[t]<a[t-1]&&a[t]<a[t+1]){const a=Math.PI*t/r;if(s.push({re:Math.cos(a),im:Math.sin(a)}),s.length>=e)break}return s}(t,a-n.length);for(const t of e)f(n,t,1e-6)}const o=function(t,e=1e-9){const r=[];for(const s of t)f(r,s,e),Math.abs(s.im)>1e-12&&f(r,{re:s.re,im:-s.im},e);return r}(n),c=[];for(const t of o)if(f(c,t,1e-9)&&c.length===a)break;return c.length>a?c.slice(0,a):c}}class b{constructor(t){this.init=t,this._zeros=null}get type(){return"FIR"}get taps(){return this.init.taps}get Fs(){return this.init.Fs}impulseResponse(t=256){return this.taps.slice(0,t)}zeros(){return this._zeros||(this._zeros=p.fromTapsRobust(this.taps)),this._zeros}frequencyGrid(t=1024){const e=r(0,Math.PI,t),a=[],n=[];for(const t of e){const e=m.H_w_FIR(this.taps,t);a.push(m.magDbFromH(e)),n.push(Math.atan2(e.im,e.re))}const i=s(n),o=m.groupDelay(i,e),c=m.phaseDelay(i,e),h=e.map(t=>t/Math.PI*(this.Fs/2));return{w:e,freqHz:h,magdB:a,phaseDeg:i.map(t=>180*t/Math.PI),gdSamples:o,pdSamples:c}}}function g(t){return 0===t?1:Math.sin(Math.PI*t)/(Math.PI*t)}class y{constructor(t){this.spec=t}design(){const{kind:t,taps:e,Fs:r,f1:s,f2:a=s,window:n="hamming",beta:i=6}=this.spec,o=(e-1)/2,c=2*Math.PI*(s/r),h=2*Math.PI*(a/r),l=u.byName(n,e,i),M=new Array(e).fill(0),f=t=>{const r=new Array(e);for(let s=0;s<e;s++)r[s]=2*t/(2*Math.PI)*g((s-o)*t/Math.PI);return r};if("lowpass"===t){const t=f(c);for(let r=0;r<e;r++)M[r]=t[r]*l[r]}else if("highpass"===t){const t=f(c);for(let r=0;r<e;r++){const e=r===o?1:0;M[r]=(e-t[r])*l[r]}}else if("bandpass"===t){const t=f(h),r=f(c);for(let s=0;s<e;s++)M[s]=(t[s]-r[s])*l[s]}else{const t=f(h),r=f(c);for(let s=0;s<e;s++){const e=s===o?1:0;M[s]=(e-(t[s]-r[s]))*l[s]}}let p=0;if("highpass"===t&&(p=Math.PI),"bandpass"===t){const t=Math.sqrt(s*a);p=2*Math.PI*(t/r)}const y=m.H_w_FIR(M,p),I=1/(Math.hypot(y.re,y.im)||1e-12);for(let t=0;t<e;t++)M[t]*=I;return new b({taps:M,Fs:r})}}class I{constructor(t){this.init=t}get type(){return"IIR"}get sections(){return this.init.sections}get Fs(){return this.init.Fs}get zPoles(){return this.init.zPoles}get zZeros(){return this.init.zZeros}impulseResponse(t=256){const e=new Array(t).fill(0);e[0]=1;let r=e.slice();for(const e of this.sections){const[s,a,n]=e.b,[,i,o]=e.a,c=new Array(t).fill(0);let h=0,l=0;for(let e=0;e<t;e++){const t=r[e]-i*h-o*l,m=s*t+a*h+n*l;c[e]=m,l=h,h=t}r=c}return r}frequencyGrid(t=1024){const e=r(0,Math.PI,t),a=[],n=[];for(const t of e){const e=m.H_w_IIR(this.sections,t);a.push(m.magDbFromH(e)),n.push(Math.atan2(e.im,e.re))}const i=s(n),o=m.groupDelay(i,e),c=m.phaseDelay(i,e),h=e.map(t=>t/Math.PI*(this.Fs/2));return{w:e,freqHz:h,magdB:a,phaseDeg:i.map(t=>180*t/Math.PI),gdSamples:o,pdSamples:c}}}function d(t,e){const r=e.re*e.re+e.im*e.im||1e-300;return{re:(t.re*e.re+0*e.im)/r,im:(0*e.re-t.re*e.im)/r}}class P{constructor(t){this.spec=t}design(){const{family:t,kind:e,Fs:r}=this.spec;let{N:s,f1:a,f2:n}=this.spec;const i=this.spec.Rp??1,h=this.spec.Rs??60;let u;switch(t){case"butter":default:u=o.butter(s);break;case"cheby1":u=o.cheby1(s,i);break;case"cheby2":u=o.cheby2(s,h);break;case"ellip":u=o.ellipHybrid(s,i,h);break;case"linkwitz":{const t=o.linkwitzRiley(s);s=t.enforcedOrder??s,u={poles:t.poles,zeros:[]};break}case"bessel":u=o.bessel(s)}u.family=t,u.order=s;let M=[],f=[];if("lowpass"===e||"highpass"===e){const n=c.prewarp(a,r),i=u.poles.map(t=>"lowpass"===e?{re:t.re*n,im:t.im*n}:d({re:n},t)),o=u.zeros.map(t=>"lowpass"===e?{re:t.re*n,im:t.im*n}:d({re:n},t));if(M=i.map(t=>c.sToZ(t,r)),f=o.map(t=>c.sToZ(t,r)),["butter","cheby1","bessel","linkwitz"].includes(t)&&"highpass"===e)for(let t=0;t<s;t++)f.push({re:1,im:0})}else{if(!n)throw new Error("bandpass/bandstop require f2");if(n<a){const t=a;a=n,n=t}const i=c.prewarp(a,r),o=c.prewarp(n,r),h=o-i,l=Math.sqrt(i*o),m=[],p=[];if("bandpass"===e){for(const t of u.poles){const[e,r]=c.quad({re:1,im:0},{re:-t.re*h,im:-t.im*h},{re:l*l,im:0});m.push(e,r)}for(const t of u.zeros){const[e,r]=c.quad({re:1,im:0},{re:-t.re*h,im:-t.im*h},{re:l*l,im:0});p.push(e,r)}if(["butter","cheby1","bessel","linkwitz"].includes(t))for(let t=0;t<s;t++)p.push({re:0,im:0});if(M=m.map(t=>c.sToZ(t,r)),f=p.map(t=>c.sToZ(t,r)),["butter","cheby1","bessel","linkwitz"].includes(t))for(let t=0;t<s;t++)f.push({re:-1,im:0});else"cheby2"===t&&s%2==1&&f.push({re:1,im:0},{re:-1,im:0})}else{for(const t of u.poles){const[e,r]=c.quad({re:t.re,im:t.im},{re:-h,im:0},{re:t.re*l*l,im:t.im*l*l});m.push(e,r)}for(const t of u.zeros){const[e,r]=c.quad({re:t.re,im:t.im},{re:-h,im:0},{re:t.re*l*l,im:t.im*l*l});p.push(e,r)}for(let t=0;t<s;t++)p.push({re:0,im:l},{re:0,im:-l});M=m.map(t=>c.sToZ(t,r)),f=p.map(t=>c.sToZ(t,r))}}const p=l.fromZPK(f,M,1);let b=0;if("highpass"===e&&(b=Math.PI),"bandpass"===e){const t=Math.sqrt(a*n);b=2*Math.PI*(t/r)}const g=m.H_w_IIR(p,b),y=1/(Math.hypot(g.re,g.im)||1e-12);return p[0].b=[p[0].b[0]*y,p[0].b[1]*y,p[0].b[2]*y],new I({sections:p,Fs:r,zPoles:M,zZeros:f})}}class w{static designFIR(t){return new y(t).design()}static designIIR(t){return new P(t).design()}}export{c as BLT,t as Cx,y as FIRDesigner,b as FIRFilter,p as FIRZeros,w as FilterDSP,P as IIRDesigner,I as IIRFilter,a as Poly,o as Prototypes,m as Response,i as Roots,l as SOS,e as TAU,u as Windows,r as linspace,s as unwrapPhase};
//# sourceMappingURL=dsp-filter-library.esm.min.js.map
