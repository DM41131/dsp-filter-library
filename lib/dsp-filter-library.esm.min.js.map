{"version":3,"file":"dsp-filter-library.esm.min.js","sources":["../src/core/Complex.js","../src/core/util.js","../src/core/Polynomial.js","../src/core/Roots.js","../src/analog/Prototypes.js","../src/digital/BLT.js","../src/digital/SOS.js","../src/digital/Response.js","../src/fir/Windows.js","../src/fir/FIRZeros.js","../src/model/FIRFilter.js","../src/fir/FIRDesigner.js","../src/model/IIRFilter.js","../src/iir/IIRDesigner.js","../src/dsp-filter-library.js"],"sourcesContent":["// Complex number operations\r\nexport class Cx {\r\n    static add(a,b){ return {re:a.re+b.re, im:a.im+b.im}; }\r\n    static sub(a,b){ return {re:a.re-b.re, im:a.im-b.im}; }\r\n    static mul(a,b){ return {re:a.re*b.re-a.im*b.im, im:a.re*b.im+a.im*b.re}; }\r\n    static div(a,b){ const d=b.re*b.re+b.im*b.im||1e-300; return {re:(a.re*b.re+a.im*b.im)/d, im:(a.im*b.re-a.re*b.im)/d}; }\r\n    static abs(a){ return Math.hypot(a.re, a.im); }\r\n    static conj(a){ return {re:a.re, im:-a.im}; }\r\n  }\r\n  ","// Utility functions\r\nexport const TAU = 2*Math.PI;\r\n\r\nexport function linspace(a,b,n){\r\n  const out=new Array(n), d=(b-a)/(n-1);\r\n  for(let i=0;i<n;i++) out[i]=a+i*d;\r\n  return out;\r\n}\r\n\r\nexport function unwrapPhase(phRad){\r\n  const out=[...phRad];\r\n  for(let pass=0; pass<2; pass++){\r\n    for(let i=1;i<out.length;i++){\r\n      const d=out[i]-out[i-1];\r\n      if(d>Math.PI) out[i]-=TAU;\r\n      if(d<-Math.PI) out[i]+=TAU;\r\n    }\r\n  }\r\n  return out;\r\n}\r\n","// Polynomial operations\r\nimport { Cx } from \"./Complex.js\";\r\n\r\n// Ascending coefficients: [a0, a1, ... aN] => a0 z^N + a1 z^(N-1) + ... + aN\r\nexport class Poly {\r\n  static evalRealAsc(coeffs, z){\r\n    let res={re:coeffs[0], im:0};\r\n    for(let i=1;i<coeffs.length;i++) res = Cx.add(Cx.mul(res,z), {re:coeffs[i], im:0});\r\n    return res;\r\n  }\r\n}\r\n","// Root finding algorithms\r\nimport { Cx } from \"./Complex.js\";\r\nimport { Poly } from \"./Polynomial.js\";\r\n\r\nfunction evalMonicAndDeriv(coeffsMonic, z){\r\n  const N = coeffsMonic.length - 1;\r\n  let p={re:1,im:0}, dp={re:0,im:0};\r\n  for(let k=1;k<=N;k++){ dp=Cx.add(Cx.mul(dp,z),p); p=Cx.add(Cx.mul(p,z),{re:coeffsMonic[k],im:0}); }\r\n  return {p,dp};\r\n}\r\n\r\nexport class Roots {\r\n  static aberthMonic(raw){\r\n    let i0=0; while(i0<raw.length-1 && Math.abs(raw[i0])<1e-18) i0++;\r\n    let cs = raw.slice(i0);\r\n    const N = cs.length - 1;\r\n    if (N <= 0) return [];\r\n    const a0 = cs[0];\r\n    cs = cs.map(c => c / a0); // monic [1, a1, ..., aN]\r\n\r\n    let maxRatio=0; for(let k=1;k<cs.length;k++) maxRatio=Math.max(maxRatio, Math.abs(cs[k]));\r\n    const r0 = Math.max(0.5, Math.min(1.5, 1+maxRatio));\r\n\r\n    const roots=new Array(N);\r\n    for(let k=0;k<N;k++){\r\n      const ang=2*Math.PI*(k+0.5)/N, jit=1+((k%2?1:-1)*1e-3);\r\n      roots[k]={re:r0*jit*Math.cos(ang), im:r0*jit*Math.sin(ang)};\r\n    }\r\n\r\n    const MAX_IT=200, TOL=1e-12, DEN_EPS=1e-14;\r\n    for(let it=0; it<MAX_IT; it++){\r\n      let moved=false;\r\n      for(let i=0;i<N;i++){\r\n        const zi=roots[i];\r\n        const {p,dp}=evalMonicAndDeriv(cs,zi);\r\n        let sumInv={re:0,im:0};\r\n        for(let j=0;j<N;j++) if(j!==i){\r\n          let dif=Cx.sub(zi,roots[j]);\r\n          const mag2=dif.re*dif.re+dif.im*dif.im;\r\n          if(mag2 < DEN_EPS*DEN_EPS) dif={re:dif.re+DEN_EPS, im:dif.im};\r\n          const inv={re:dif.re/(mag2||1e-300), im:-dif.im/(mag2||1e-300)};\r\n          sumInv=Cx.add(sumInv,inv);\r\n        }\r\n        const denom=Cx.sub(dp, Cx.mul(p,sumInv));\r\n        const delta=Cx.div(p,denom);\r\n        const ni=Cx.sub(zi,delta);\r\n        if(Math.hypot(ni.re-zi.re, ni.im-zi.im)>TOL) moved=true;\r\n        roots[i]=ni;\r\n      }\r\n      if(!moved) break;\r\n    }\r\n    return roots;\r\n  }\r\n\r\n  static dkScaled(raw){\r\n    let i0=0; while(i0<raw.length-1 && Math.abs(raw[i0])<1e-18) i0++;\r\n    const poly=raw.slice(i0);\r\n    const N=poly.length-1;\r\n    if(N<=0) return [];\r\n    const a0=poly[0];\r\n    const monic=poly.map(c=>c/a0);\r\n\r\n    const results=[];\r\n    for(const R of [0.8,1.1,1.5]){\r\n      const roots=new Array(N);\r\n      for(let k=0;k<N;k++){ const ang=2*Math.PI*(k+1)/N; roots[k]={re:R*Math.cos(ang), im:R*Math.sin(ang)}; }\r\n      for(let it=0;it<200;it++){\r\n        let moved=false;\r\n        for(let i=0;i<N;i++){\r\n          let denom={re:1,im:0};\r\n          for(let j=0;j<N;j++) if(i!==j) denom=Cx.mul(denom, Cx.sub(roots[i], roots[j]));\r\n          const f=Poly.evalRealAsc(monic, roots[i]);\r\n          const delta=Cx.div(f,denom);\r\n          const ni=Cx.sub(roots[i], delta);\r\n          if(Math.hypot(ni.re-roots[i].re, ni.im-roots[i].im)>1e-12) moved=true;\r\n          roots[i]=ni;\r\n        }\r\n        if(!moved) break;\r\n      }\r\n      results.push(...roots);\r\n    }\r\n    return results;\r\n  }\r\n}\r\n","// Analog filter prototypes\r\nimport { Poly } from \"../core/Polynomial.js\";\r\n\r\nexport class Prototypes {\r\n  static butter(N){\r\n    const poles=[], zeros=[];\r\n    for(let k=1;k<=N;k++){ const th=(2*k-1)*Math.PI/(2*N); poles.push({re:-Math.sin(th), im:Math.cos(th)}); }\r\n    return {poles, zeros};\r\n  }\r\n  static cheby1(N, Rp){\r\n    const eps=Math.sqrt(Math.pow(10, Rp/10)-1), alpha=Math.asinh(1/eps)/N;\r\n    const poles=[], zeros=[];\r\n    for(let k=1;k<=N;k++){ const th=(2*k-1)*Math.PI/(2*N); poles.push({re:-Math.sinh(alpha)*Math.sin(th), im:Math.cosh(alpha)*Math.cos(th)}); }\r\n    return {poles, zeros};\r\n  }\r\n  static cheby2(N, Rs){\r\n    const eps2=1/Math.sqrt(Math.pow(10, Rs/10)-1), alpha=Math.asinh(1/eps2)/N;\r\n    const poles=[], zeros=[];\r\n    for(let k=1;k<=N;k++){ const th=(2*k-1)*Math.PI/(2*N); poles.push({re:-Math.sinh(alpha)*Math.sin(th), im:Math.cosh(alpha)*Math.cos(th)}); }\r\n    const M=Math.floor(N/2);\r\n    for(let k=1;k<=M;k++){ const th=(2*k-1)*Math.PI/(2*N), Oz=1/Math.cos(th); zeros.push({re:0,im: Oz}, {re:0,im:-Oz}); }\r\n    return {poles, zeros};\r\n  }\r\n  // Educational hybrid (not exact elliptic)\r\n  static ellipHybrid(N, Rp, Rs){\r\n    const p=Prototypes.cheby1(N,Rp), z=Prototypes.cheby2(N,Rs);\r\n    return {poles:p.poles, zeros:z.zeros};\r\n  }\r\n  static linkwitzRiley(N){\r\n    const evenN=(N%2===0)?N:N+1;\r\n    const base=Prototypes.butter(evenN/2);\r\n    const poles=[]; base.poles.forEach(pl=>{ poles.push(pl,{re:pl.re,im:pl.im}); });\r\n    return {poles, zeros:[], enforcedOrder:evenN};\r\n  }\r\n  static bessel(N){\r\n    const n=Math.min(N,12); const a=new Array(n+1).fill(0); a[0]=1;\r\n    for(let k=1;k<=n;k++) a[k]=a[k-1]*((n+k)*(n-k+1))/(2*k);\r\n    // tiny DK for Bessel poly (ascending coeff eval)\r\n    const poles = (() => {\r\n      const nn=a.length-1, R=1.5, z=new Array(nn);\r\n      for(let i=0;i<nn;i++){ const ang=2*Math.PI*(i+1)/nn; z[i]={re:R*Math.cos(ang), im:R*Math.sin(ang)}; }\r\n      for(let it=0; it<200; it++){\r\n        let moved=false;\r\n        for(let i=0;i<nn;i++){\r\n          let denom={re:1,im:0};\r\n          for(let j=0;j<nn;j++) if(i!==j) denom={re:denom.re*(z[i].re-z[j].re)-denom.im*(z[i].im-z[j].im), im:denom.re*(z[i].im-z[j].im)+denom.im*(z[i].re-z[j].re)};\r\n          const f=Poly.evalRealAsc(a, z[i]);\r\n          const delta={re:f.re/(denom.re||1e-300), im:f.im/(denom.re||1e-300)}; // crude but ok\r\n          const ni={re:z[i].re-delta.re, im:z[i].im-delta.im};\r\n          if(Math.hypot(ni.re-z[i].re, ni.im-z[i].im)>1e-12) moved=true;\r\n          z[i]=ni;\r\n        }\r\n        if(!moved) break;\r\n      }\r\n      return z.filter(r=> r.re<0 || Math.abs(r.re)<1e-12);\r\n    })();\r\n    return {poles, zeros:[]};\r\n  }\r\n}\r\n","// Bilinear Transform\r\nimport { Cx } from \"../core/Complex.js\";\r\n\r\nexport class BLT {\r\n  static prewarp(f, Fs){ return 2*Fs*Math.tan(Math.PI*f/Fs); }\r\n  static sToZ(s, Fs){\r\n    const a={re:2*Fs+s.re, im:s.im}, b={re:2*Fs-s.re, im:-s.im};\r\n    return Cx.div(a,b);\r\n  }\r\n  static quad(a,b,c){\r\n    function cSqrt(z){\r\n      const x=z.re,y=z.im,r=Math.hypot(x,y),t=Math.sqrt((r+Math.abs(x))/2);\r\n      if(x>=0) return {re:t, im: y/(2*(t||1e-300))};\r\n      const im=(y>=0?1:-1)*t; return {re: y/(2*(im||1e-300)), im};\r\n    }\r\n    const b2=Cx.mul(b,b), fourac=Cx.mul({re:4,im:0}, Cx.mul(a,c));\r\n    const disc= {re:b2.re-fourac.re, im:b2.im-fourac.im};\r\n    const s=cSqrt(disc), negb={re:-b.re,im:-b.im}, twoa=Cx.mul({re:2,im:0},a);\r\n    return [ Cx.div(Cx.add(negb,s),twoa), Cx.div(Cx.sub(negb,s),twoa) ];\r\n  }\r\n}\r\n","// Second Order Sections\r\nimport { Cx } from \"../core/Complex.js\";\r\n\r\nfunction pairConjs(arr){\r\n  const used=new Array(arr.length).fill(false), pairs=[];\r\n  for(let i=0;i<arr.length;i++){\r\n    if(used[i]) continue; const a=arr[i]; let matched=false;\r\n    for(let j=i+1;j<arr.length;j++) if(!used[j]){\r\n      const b=arr[j];\r\n      if(Math.abs(a.re-b.re)<1e-10 && Math.abs(a.im+b.im)<1e-10){\r\n        pairs.push([a,b]); used[i]=used[j]=true; matched=true; break;\r\n      }\r\n    }\r\n    if(!matched){ pairs.push([a]); used[i]=true; }\r\n  }\r\n  return pairs;\r\n}\r\n\r\nexport class SOS {\r\n  static fromZPK(zZeros, zPoles, gain=1){\r\n    while(zZeros.length<zPoles.length) zZeros.push({re:-1,im:0});\r\n    const zp=pairConjs(zZeros), pp=pairConjs(zPoles);\r\n    const sections=[]; let zi=0, pi=0;\r\n    while(pi<pp.length){\r\n      const ppair=pp[pi++], zpair=(zi<zp.length)?zp[zi++]:[{re:-1,im:0},{re:-1,im:0}];\r\n      const p1=ppair[0], p2=ppair[1]||{re:0,im:0};\r\n      const z1=zpair[0], z2=zpair[1]||{re:-1,im:0};\r\n      const sumZ={re:z1.re+z2.re, im:z1.im+z2.im}, prodZ=Cx.mul(z1,z2);\r\n      const sumP={re:p1.re+p2.re, im:p1.im+p2.im}, prodP=Cx.mul(p1,p2);\r\n      const b=[1, -sumZ.re, prodZ.re];\r\n      const a=[1, -sumP.re, prodP.re];\r\n      sections.push({b,a});\r\n    }\r\n    if(sections.length) sections[0].b=[sections[0].b[0]*gain, sections[0].b[1]*gain, sections[0].b[2]*gain];\r\n    return sections;\r\n  }\r\n}\r\n","// Digital filter response calculations\r\nimport { Cx } from \"../core/Complex.js\";\r\nimport { unwrapPhase } from \"../core/util.js\";\r\n\r\nexport class Response {\r\n  static H_w_IIR(sections,w){\r\n    const z1={re:Math.cos(w),im:-Math.sin(w)}, z2={re:Math.cos(2*w),im:-Math.sin(2*w)};\r\n    let acc={re:1,im:0};\r\n    for(const s of sections){\r\n      const [b0,b1,b2]=s.b, [,a1,a2]=s.a;\r\n      const num={re:b0+b1*z1.re+b2*z2.re, im:b1*z1.im+b2*z2.im};\r\n      const den={re:1+a1*z1.re+a2*z2.re, im:a1*z1.im+a2*z2.im};\r\n      const den2=den.re*den.re+den.im*den.im;\r\n      const h={re:(num.re*den.re+num.im*den.im)/den2, im:(num.im*den.re-num.re*den.im)/den2};\r\n      acc = Cx.mul(acc,h);\r\n    }\r\n    return acc;\r\n  }\r\n  static H_w_FIR(taps,w){\r\n    let re=0, im=0;\r\n    for(let n=0;n<taps.length;n++){ re += taps[n]*Math.cos(w*n); im -= taps[n]*Math.sin(w*n); }\r\n    return {re, im};\r\n  }\r\n  static magDbFromH(H){ return 20*Math.log10(Math.max(1e-16, Cx.abs(H))); }\r\n  static unwrapToDeg(phRad){ return unwrapPhase(phRad).map(v=>v*180/Math.PI); }\r\n  static groupDelay(phUnwrappedRad, w){\r\n    const N=w.length, gd=new Array(N).fill(0);\r\n    if(N>=3){\r\n      for(let i=1;i<N-1;i++){\r\n        const dphi=phUnwrappedRad[i+1]-phUnwrappedRad[i-1], dw=w[i+1]-w[i-1];\r\n        gd[i] = - dphi / (dw || 1e-12);\r\n      }\r\n      gd[0]=gd[1]; gd[N-1]=gd[N-2];\r\n    }\r\n    return gd;\r\n  }\r\n  static phaseDelay(phUnwrappedRad, w){\r\n    const pd=new Array(w.length).fill(0);\r\n    for(let i=0;i<w.length;i++) pd[i] = (w[i]===0 ? NaN : -phUnwrappedRad[i]/w[i]);\r\n    let firstFinite = pd.find(v=>Number.isFinite(v)); if(!Number.isFinite(firstFinite)) firstFinite=0;\r\n    for(let i=0;i<pd.length && !Number.isFinite(pd[i]); i++) pd[i]=firstFinite;\r\n    for(let i=1;i<pd.length;i++) if(!Number.isFinite(pd[i])) pd[i]=pd[i-1];\r\n    return pd;\r\n  }\r\n}\r\n","// windows.js — Windowing functions for DSP\r\n// Author: Davit Akobia <dav.akobia@gmail.com>\r\n// License: MIT\r\n\r\n/**\r\n * Windowing functions for digital signal processing\r\n */\r\nexport class Windows {\r\n    static rect(N) { \r\n        return Array.from({ length: N }, () => 1); \r\n    }\r\n    \r\n    static rectangle(N) { \r\n        return Windows.rect(N); \r\n    }\r\n    \r\n    static hann(N) { \r\n        return Array.from({ length: N }, (_, n) => 0.5 - 0.5*Math.cos(2*Math.PI*n/(N-1))); \r\n    }\r\n    \r\n    static hamming(N) { \r\n        return Array.from({ length: N }, (_, n) => 0.54 - 0.46*Math.cos(2*Math.PI*n/(N-1))); \r\n    }\r\n    \r\n    static blackman(N) {\r\n        const a0 = 0.42, a1 = 0.5, a2 = 0.08;\r\n        return Array.from({ length: N }, (_, n) =>\r\n            a0 - a1*Math.cos(2*Math.PI*n/(N-1)) + a2*Math.cos(4*Math.PI*n/(N-1)));\r\n    }\r\n    \r\n    static blackmanHarris(N) {\r\n        const a0 = 0.35875, a1 = 0.48829, a2 = 0.14128, a3 = 0.01168;\r\n        return Array.from({ length: N }, (_, n) =>\r\n            a0 - a1*Math.cos(2*Math.PI*n/(N-1)) + a2*Math.cos(4*Math.PI*n/(N-1)) - a3*Math.cos(6*Math.PI*n/(N-1)));\r\n    }\r\n    \r\n    static blackmanNuttall(N) {\r\n        const a0 = 0.3635819, a1 = 0.4891775, a2 = 0.1365995, a3 = 0.0106411;\r\n        return Array.from({ length: N }, (_, n) =>\r\n            a0 - a1*Math.cos(2*Math.PI*n/(N-1)) + a2*Math.cos(4*Math.PI*n/(N-1)) - a3*Math.cos(6*Math.PI*n/(N-1)));\r\n    }\r\n    \r\n    static kaiser(N, beta = 8.6) {\r\n        const denom = _i0(beta), M = N - 1;\r\n        return Array.from({ length: N }, (_, n) => {\r\n            const t = (2*n)/M - 1;\r\n            return _i0(beta * Math.sqrt(1 - t*t)) / denom;\r\n        });\r\n    }\r\n    \r\n    static tukey(N, alpha = 0.5) {\r\n        const M = N - 1;\r\n        return Array.from({ length: N }, (_, n) => {\r\n            const x = n / M;\r\n            if (alpha <= 0) return 1;\r\n            if (alpha >= 1) return 0.5*(1 - Math.cos(2*Math.PI*x));\r\n            if (x < alpha/2) return 0.5*(1 + Math.cos(Math.PI*(2*x/alpha - 1)));\r\n            if (x <= 1 - alpha/2) return 1;\r\n            return 0.5*(1 + Math.cos(Math.PI*(2*x/alpha - 2/alpha + 1)));\r\n        });\r\n    }\r\n    \r\n    static gauss(N, sigma = 0.4) {\r\n        const M = N - 1, m2 = M/2;\r\n        return Array.from({ length: N }, (_, n) => {\r\n            const k = (n - m2) / (sigma * m2);\r\n            return Math.exp(-0.5*k*k);\r\n        });\r\n    }\r\n    \r\n    static bartlett(N) {\r\n        const M = N - 1;\r\n        return Array.from({ length: N }, (_, n) => 1 - Math.abs((n - M/2)/(M/2)));\r\n    }\r\n    \r\n    static bartlettHann(N) {\r\n        const M = N - 1;\r\n        return Array.from({ length: N }, (_, n) => {\r\n            const x = n / M;\r\n            return 0.62 - 0.48*Math.abs(x - 0.5) - 0.38*Math.cos(2*Math.PI*x);\r\n        });\r\n    }\r\n    \r\n    static cosine(N) {\r\n        const M = N - 1;\r\n        return Array.from({ length: N }, (_, n) => Math.sin(Math.PI*n/M));\r\n    }\r\n    \r\n    static lanczos(N) {\r\n        const M = N - 1, m2 = M/2;\r\n        const sinc = (x) => x === 0 ? 1 : Math.sin(Math.PI*x)/(Math.PI*x);\r\n        return Array.from({ length: N }, (_, n) => sinc((n - m2)/m2));\r\n    }\r\n    \r\n    static bohman(N) {\r\n        const M = N - 1, m2 = M/2;\r\n        return Array.from({ length: N }, (_, n) => {\r\n            const x = Math.abs(n - m2) / m2;\r\n            return (x <= 1) ? (1 - x)*Math.cos(Math.PI*x) + (1/Math.PI)*Math.sin(Math.PI*x) : 0;\r\n        });\r\n    }\r\n    \r\n    static flatTop(N) {\r\n        const a0 = 1.0, a1 = 1.93, a2 = 1.29, a3 = 0.388, a4 = 0.028;\r\n        const M = N - 1;\r\n        return Array.from({ length: N }, (_, n) =>\r\n            a0 - a1*Math.cos(2*Math.PI*n/M) + a2*Math.cos(4*Math.PI*n/M) -\r\n            a3*Math.cos(6*Math.PI*n/M) + a4*Math.cos(8*Math.PI*n/M)\r\n        );\r\n    }\r\n    \r\n    // Additional window functions\r\n    static nuttall(N) {\r\n        const a0 = 0.355768, a1 = 0.487396, a2 = 0.144232, a3 = 0.012604;\r\n        return Array.from({ length: N }, (_, n) =>\r\n            a0 - a1*Math.cos(2*Math.PI*n/(N-1)) + a2*Math.cos(4*Math.PI*n/(N-1)) - a3*Math.cos(6*Math.PI*n/(N-1)));\r\n    }\r\n    \r\n    static parzen(N) {\r\n        const M = N - 1, m2 = M/2;\r\n        return Array.from({ length: N }, (_, n) => {\r\n            const x = Math.abs(n - m2) / m2;\r\n            if (x <= 0.5) return 1 - 6*x*x*(1 - x);\r\n            return 2*Math.pow(1 - x, 3);\r\n        });\r\n    }\r\n    \r\n    static welch(N) {\r\n        const M = N - 1;\r\n        return Array.from({ length: N }, (_, n) => 1 - Math.pow((n - M/2)/(M/2), 2));\r\n    }\r\n    \r\n    static triangular(N) {\r\n        const M = N - 1;\r\n        return Array.from({ length: N }, (_, n) => 1 - Math.abs((2*n - M)/M));\r\n    }\r\n    \r\n    static poisson(N, alpha = 2) {\r\n        const M = N - 1, m2 = M/2;\r\n        return Array.from({ length: N }, (_, n) => Math.exp(-alpha * Math.abs(n - m2)/m2));\r\n    }\r\n    \r\n    static hanning(N) {\r\n        return Windows.hann(N); // Alias for Hann window\r\n    }\r\n    \r\n    static vonHann(N) {\r\n        return Windows.hann(N); // Another alias for Hann window\r\n    }\r\n    \r\n    static nuttallBlackmanHarris(N) {\r\n        return Windows.blackmanNuttall(N); // Alias\r\n    }\r\n    \r\n    static exactBlackman(N) {\r\n        const a0 = 0.42659, a1 = 0.49656, a2 = 0.076849;\r\n        return Array.from({ length: N }, (_, n) =>\r\n            a0 - a1*Math.cos(2*Math.PI*n/(N-1)) + a2*Math.cos(4*Math.PI*n/(N-1)));\r\n    }\r\n    \r\n    static dolphChebyshev(N, alpha = 50) {\r\n        const M = N - 1, m2 = M/2;\r\n        const beta = Math.cosh(Math.acosh(Math.pow(10, alpha/20)) / M);\r\n        const chebyshev = (n, x) => {\r\n            if (Math.abs(x) <= 1) return Math.cos(n * Math.acos(x));\r\n            return Math.cosh(n * Math.acosh(x));\r\n        };\r\n        \r\n        const w = new Array(N);\r\n        for (let k = 0; k < N; k++) {\r\n            let sum = 0;\r\n            for (let m = 0; m < N; m++) {\r\n                const x = beta * Math.cos(Math.PI * m / N);\r\n                sum += chebyshev(M, x) * Math.cos(2 * Math.PI * k * m / N);\r\n            }\r\n            w[k] = sum / N;\r\n        }\r\n        \r\n        // Normalize\r\n        const max = Math.max(...w);\r\n        return w.map(x => x / max);\r\n    }\r\n    \r\n    static taylor(N, nbar = 4, sll = -30) {\r\n        const M = N - 1, m2 = M/2;\r\n        const A = Math.acosh(Math.pow(10, -sll/20)) / Math.PI;\r\n        const sigma = nbar / Math.sqrt(A*A + (nbar - 0.5)*(nbar - 0.5));\r\n        \r\n        return Array.from({ length: N }, (_, n) => {\r\n            const x = (n - m2) / m2;\r\n            let w = 1;\r\n            for (let m = 1; m < nbar; m++) {\r\n                const fm = Math.sqrt(1 - (m/(A*A + (m - 0.5)*(m - 0.5))));\r\n                w += 2 * fm * Math.cos(2 * Math.PI * m * x);\r\n            }\r\n            return w / (2 * nbar - 1);\r\n        });\r\n    }\r\n    \r\n    static gaussian(N, sigma = 0.4) {\r\n        return Windows.gauss(N, sigma); // Alias\r\n    }\r\n    \r\n    static raisedCosine(N, alpha = 0.5) {\r\n        return Windows.tukey(N, alpha); // Alias for Tukey window\r\n    }\r\n    \r\n    /** @param {keyof Windows| string} name */\r\n    static byName(name, N, opts = {}) {\r\n        const { beta = 8.6, alpha = 0.5, sigma = 0.4, nbar = 4, sll = -30 } = opts || {};\r\n        switch (name) {\r\n            case 'hann':\r\n            case 'hanning':\r\n            case 'vonHann': return Windows.hann(N);\r\n            case 'hamming': return Windows.hamming(N);\r\n            case 'blackman': return Windows.blackman(N);\r\n            case 'blackmanHarris': return Windows.blackmanHarris(N);\r\n            case 'blackmanNuttall':\r\n            case 'nuttallBlackmanHarris': return Windows.blackmanNuttall(N);\r\n            case 'nuttall': return Windows.nuttall(N);\r\n            case 'exactBlackman': return Windows.exactBlackman(N);\r\n            case 'rectangle':\r\n            case 'rect': return Windows.rect(N);\r\n            case 'bartlett': return Windows.bartlett(N);\r\n            case 'bartlettHann': return Windows.bartlettHann(N);\r\n            case 'cosine': return Windows.cosine(N);\r\n            case 'lanczos': return Windows.lanczos(N);\r\n            case 'bohman': return Windows.bohman(N);\r\n            case 'gauss':\r\n            case 'gaussian': return Windows.gauss(N, sigma);\r\n            case 'tukey':\r\n            case 'raisedCosine': return Windows.tukey(N, alpha);\r\n            case 'kaiser': return Windows.kaiser(N, beta);\r\n            case 'flatTop':\r\n            case 'flattop': return Windows.flatTop(N);\r\n            case 'parzen': return Windows.parzen(N);\r\n            case 'welch': return Windows.welch(N);\r\n            case 'triangular': return Windows.triangular(N);\r\n            case 'poisson': return Windows.poisson(N, alpha);\r\n            case 'dolphChebyshev': return Windows.dolphChebyshev(N, alpha);\r\n            case 'taylor': return Windows.taylor(N, nbar, sll);\r\n            default: return Windows.hamming(N);\r\n        }\r\n    }\r\n}\r\n\r\n// Modified Bessel function of the first kind, order zero\r\nconst _i0 = (x) => {\r\n    const ax = Math.abs(x);\r\n    if (ax < 3.75) {\r\n        const t = x / 3.75, t2 = t*t;\r\n        return 1 + t2 * (3.5156229 + t2 * (3.0899424 + t2 * (1.2067492 +\r\n                t2 * (0.2659732 + t2 * (0.0360768 + t2 * 0.0045813)))));\r\n    } else {\r\n        const t = 3.75 / ax;\r\n        return (Math.exp(ax) / Math.sqrt(ax)) * (\r\n            0.39894228 + t * (0.01328592 + t * (0.00225319 + t * (-0.00157565 +\r\n            t * (0.00916281 + t * (-0.02057706 + t * (0.02635537 + t *\r\n            (-0.01647633 + t * 0.00392377)))))))\r\n        );\r\n    }\r\n};","// FIR filter zeros\r\nimport { Roots } from \"../core/Roots.js\";\r\nimport { Response } from \"../digital/Response.js\";\r\n\r\nfunction pushUnique(arr, z, tol=1e-9){ for(const q of arr) if(Math.hypot(q.re-z.re, q.im-z.im)<tol) return false; arr.push(z); return true; }\r\nfunction enforceConjugates(roots, tol=1e-9){\r\n  const out=[]; for(const r of roots){ pushUnique(out,r,tol); if(Math.abs(r.im)>1e-12) pushUnique(out,{re:r.re, im:-r.im}, tol); } return out;\r\n}\r\n\r\nexport class FIRZeros {\r\n  static fromTapsRobust(taps){\r\n    const M=taps.length-1;\r\n    const coeffs=new Array(taps.length);\r\n    for(let k=0;k<taps.length;k++) coeffs[k]=taps[M-k];\r\n\r\n    let i0=0; while(i0<coeffs.length-1 && Math.abs(coeffs[i0])<1e-18) i0++;\r\n    const poly=coeffs.slice(i0);\r\n    const N=poly.length-1;\r\n    if(N<=0) return [];\r\n\r\n    const cand=[];\r\n    try { for(const z of Roots.aberthMonic(coeffs)) if(Number.isFinite(z.re)&&Number.isFinite(z.im)) pushUnique(cand,z); } catch{/* ignore */}\r\n    try { for(const z of Roots.dkScaled(coeffs))    if(Number.isFinite(z.re)&&Number.isFinite(z.im)) pushUnique(cand,z); } catch{/* ignore */}\r\n\r\n    if(cand.length < N){\r\n      const need=N-cand.length, extra=approxUnitCircleMinima(taps, need);\r\n      for(const z of extra) pushUnique(cand,z,1e-6);\r\n    }\r\n\r\n    const roots=enforceConjugates(cand);\r\n    const out=[]; for(const z of roots){ if(pushUnique(out,z,1e-9) && out.length===N) break; }\r\n    return out.length>N ? out.slice(0,N) : out;\r\n  }\r\n}\r\n\r\nfunction approxUnitCircleMinima(taps, want){\r\n  const K=8192, picks=[], mags=new Float64Array(K+1);\r\n  for(let i=0;i<=K;i++){ const w=Math.PI*i/K; const H=Response.H_w_FIR(taps,w); mags[i]=Math.hypot(H.re,H.im); }\r\n  for(let i=1;i<K;i++){\r\n    if(mags[i]<mags[i-1] && mags[i]<mags[i+1]){\r\n      const w=Math.PI*i/K; picks.push({re:Math.cos(w), im:Math.sin(w)}); if(picks.length>=want) break;\r\n    }\r\n  }\r\n  return picks;\r\n}\r\n","// FIR filter model\r\nimport { linspace, unwrapPhase } from \"../core/util.js\";\r\nimport { Response } from \"../digital/Response.js\";\r\nimport { FIRZeros } from \"../fir/FIRZeros.js\";\r\n\r\nexport class FIRFilter {\r\n  constructor(init){ this.init = init; this._zeros = null; } // {taps, Fs}\r\n  get type(){ return 'FIR'; }\r\n  get taps(){ return this.init.taps; }\r\n  get Fs(){ return this.init.Fs; }\r\n\r\n  impulseResponse(L=256){ return this.taps.slice(0,L); }\r\n  zeros(){ if(!this._zeros) this._zeros = FIRZeros.fromTapsRobust(this.taps); return this._zeros; }\r\n\r\n  frequencyGrid(Nf=1024){\r\n    const w=linspace(0,Math.PI,Nf), magdB=[], phRad=[];\r\n    for(const wi of w){ const H=Response.H_w_FIR(this.taps, wi); magdB.push(Response.magDbFromH(H)); phRad.push(Math.atan2(H.im,H.re)); }\r\n    const phU=unwrapPhase(phRad), gd=Response.groupDelay(phU, w), pd=Response.phaseDelay(phU, w);\r\n    const freqHz=w.map(wi=> wi/Math.PI*(this.Fs/2)), phaseDeg=phU.map(v=>v*180/Math.PI);\r\n    return { w, freqHz, magdB, phaseDeg, gdSamples:gd, pdSamples:pd };\r\n  }\r\n}\r\n","// FIR filter designer\r\nimport { Response } from \"../digital/Response.js\";\r\nimport { Windows } from \"./Windows.js\";\r\nimport { FIRFilter } from \"../model/FIRFilter.js\";\r\n\r\nfunction sincNorm(x){ return x===0 ? 1 : Math.sin(Math.PI*x)/(Math.PI*x); }\r\n\r\nexport class FIRDesigner {\r\n  constructor(spec){\r\n    this.spec = spec; // {kind,taps,Fs,f1,f2?,window?,beta?}\r\n  }\r\n  design(){\r\n    const { kind, taps: M, Fs, f1, f2=f1, window='hamming', beta=6 } = this.spec;\r\n    const mid=(M-1)/2, w1=2*Math.PI*(f1/Fs), w2=2*Math.PI*(f2/Fs);\r\n    const win=Windows.byName(window, M, beta), h=new Array(M).fill(0);\r\n\r\n    const lpAt=(omega_c)=>{\r\n      const hlp=new Array(M);\r\n      for(let n=0;n<M;n++) hlp[n]= 2*omega_c/(2*Math.PI) * sincNorm((n-mid)*omega_c/Math.PI);\r\n      return hlp;\r\n    };\r\n\r\n    if(kind==='lowpass'){\r\n      const hlp=lpAt(w1); for(let n=0;n<M;n++) h[n]=hlp[n]*win[n];\r\n    } else if(kind==='highpass'){\r\n      const hlp=lpAt(w1); for(let n=0;n<M;n++){ const d=(n===mid)?1:0; h[n]=(d-hlp[n])*win[n]; }\r\n    } else if(kind==='bandpass'){\r\n      const h2=lpAt(w2), h1=lpAt(w1); for(let n=0;n<M;n++) h[n]=(h2[n]-h1[n])*win[n];\r\n    } else {\r\n      const h2=lpAt(w2), h1=lpAt(w1);\r\n      for(let n=0;n<M;n++){ const d=(n===mid)?1:0; h[n]=(d-(h2[n]-h1[n]))*win[n]; }\r\n    }\r\n\r\n    let wRef=0;\r\n    if(kind==='highpass') wRef=Math.PI;\r\n    if(kind==='bandpass'){ const f0=Math.sqrt(f1*f2); wRef=2*Math.PI*(f0/Fs); }\r\n    const Href=Response.H_w_FIR(h,wRef), g=1/(Math.hypot(Href.re,Href.im)||1e-12);\r\n    for(let n=0;n<M;n++) h[n]*=g;\r\n\r\n    return new FIRFilter({taps:h, Fs});\r\n  }\r\n}\r\n","// IIR filter model\r\nimport { linspace, unwrapPhase } from \"../core/util.js\";\r\nimport { Response } from \"../digital/Response.js\";\r\n\r\nexport class IIRFilter {\r\n  constructor(init){ this.init = init; } // {sections, Fs, zPoles, zZeros}\r\n  get type(){ return 'IIR'; }\r\n  get sections(){ return this.init.sections; }\r\n  get Fs(){ return this.init.Fs; }\r\n  get zPoles(){ return this.init.zPoles; }\r\n  get zZeros(){ return this.init.zZeros; }\r\n\r\n  impulseResponse(L=256){\r\n    const x=new Array(L).fill(0); x[0]=1; let buf=x.slice();\r\n    for(const s of this.sections){\r\n      const [b0,b1,b2]=s.b, [,a1,a2]=s.a;\r\n      const out=new Array(L).fill(0); let v1=0,v2=0;\r\n      for(let n=0;n<L;n++){ const w=buf[n]-a1*v1-a2*v2; const yn=b0*w+b1*v1+b2*v2; out[n]=yn; v2=v1; v1=w; }\r\n      buf=out;\r\n    }\r\n    return buf;\r\n  }\r\n\r\n  frequencyGrid(Nf=1024){\r\n    const w=linspace(0,Math.PI,Nf), magdB=[], phRad=[];\r\n    for(const wi of w){ const H=Response.H_w_IIR(this.sections, wi); magdB.push(Response.magDbFromH(H)); phRad.push(Math.atan2(H.im,H.re)); }\r\n    const phU=unwrapPhase(phRad), gd=Response.groupDelay(phU, w), pd=Response.phaseDelay(phU, w);\r\n    const freqHz=w.map(wi=> wi/Math.PI*(this.Fs/2)), phaseDeg=phU.map(v=>v*180/Math.PI);\r\n    return { w, freqHz, magdB, phaseDeg, gdSamples:gd, pdSamples:pd };\r\n  }\r\n}\r\n","// IIR filter designer\r\nimport { BLT } from \"../digital/BLT.js\";\r\nimport { Response } from \"../digital/Response.js\";\r\nimport { SOS } from \"../digital/SOS.js\";\r\nimport { Prototypes } from \"../analog/Prototypes.js\";\r\nimport { IIRFilter } from \"../model/IIRFilter.js\";\r\n\r\nfunction divC(a,b){ const d=b.re*b.re+b.im*b.im||1e-300; return {re:(a.re*b.re+0*b.im)/d, im:(0*b.re-a.re*b.im)/d}; }\r\n\r\nexport class IIRDesigner {\r\n  constructor(spec){\r\n    this.spec = spec; // {family, kind, N, Rp?, Rs?, Fs, f1, f2?}\r\n  }\r\n  design(){\r\n    const { family, kind, Fs } = this.spec;\r\n    let { N, f1, f2 } = this.spec;\r\n    const Rp=this.spec.Rp ?? 1, Rs=this.spec.Rs ?? 60;\r\n\r\n    // Prototype\r\n    let proto;\r\n    switch(family){\r\n      case 'butter': proto=Prototypes.butter(N); break;\r\n      case 'cheby1': proto=Prototypes.cheby1(N, Rp); break;\r\n      case 'cheby2': proto=Prototypes.cheby2(N, Rs); break;\r\n      case 'ellip':  proto=Prototypes.ellipHybrid(N, Rp, Rs); break;\r\n      case 'linkwitz': {\r\n        const lr=Prototypes.linkwitzRiley(N);\r\n        N=lr.enforcedOrder ?? N;\r\n        proto={poles:lr.poles, zeros:[]};\r\n        break;\r\n      }\r\n      case 'bessel': proto=Prototypes.bessel(N); break;\r\n      default: proto=Prototypes.butter(N);\r\n    }\r\n    proto.family=family; proto.order=N;\r\n\r\n    // Map + BLT\r\n    let zPoles=[], zZeros=[];\r\n    if(kind==='lowpass'||kind==='highpass'){\r\n      const Oc=BLT.prewarp(f1,Fs);\r\n      const sPoles=proto.poles.map(p=> kind==='lowpass'? {re:p.re*Oc, im:p.im*Oc} : divC({re:Oc,im:0}, p));\r\n      const sZeros=proto.zeros.map(z=> kind==='lowpass'? {re:z.re*Oc, im:z.im*Oc} : divC({re:Oc,im:0}, z));\r\n      zPoles=sPoles.map(s=>BLT.sToZ(s,Fs));\r\n      zZeros=sZeros.map(s=>BLT.sToZ(s,Fs));\r\n      if((['butter','cheby1','bessel','linkwitz'].includes(family)) && kind==='highpass'){\r\n        for(let k=0;k<N;k++) zZeros.push({re:1,im:0});\r\n      }\r\n    } else {\r\n      if(!f2) throw new Error('bandpass/bandstop require f2');\r\n      if(f2<f1){ const t=f1; f1=f2; f2=t; }\r\n      const O1=BLT.prewarp(f1,Fs), O2=BLT.prewarp(f2,Fs), B=O2-O1, O0=Math.sqrt(O1*O2);\r\n      const sPoles=[], sZeros=[];\r\n      if(kind==='bandpass'){\r\n        for(const p of proto.poles){ const [r1,r2]=BLT.quad({re:1,im:0},{re:-(p.re*B),im:-(p.im*B)},{re:O0*O0,im:0}); sPoles.push(r1,r2); }\r\n        for(const z of proto.zeros){ const [r1,r2]=BLT.quad({re:1,im:0},{re:-(z.re*B),im:-(z.im*B)},{re:O0*O0,im:0}); sZeros.push(r1,r2); }\r\n        if(['butter','cheby1','bessel','linkwitz'].includes(family)){ for(let k=0;k<N;k++) sZeros.push({re:0,im:0}); }\r\n        zPoles=sPoles.map(s=>BLT.sToZ(s,Fs)); zZeros=sZeros.map(s=>BLT.sToZ(s,Fs));\r\n        if(['butter','cheby1','bessel','linkwitz'].includes(family)){ for(let k=0;k<N;k++) zZeros.push({re:-1,im:0}); }\r\n        else if(family==='cheby2' && (N%2===1)){ zZeros.push({re:1,im:0},{re:-1,im:0}); }\r\n      } else {\r\n        for(const p of proto.poles){ const [r1,r2]=BLT.quad({re:p.re,im:p.im},{re:-B,im:0},{re:p.re*O0*O0,im:p.im*O0*O0}); sPoles.push(r1,r2); }\r\n        for(const z of proto.zeros){ const [r1,r2]=BLT.quad({re:z.re,im:z.im},{re:-B,im:0},{re:z.re*O0*O0,im:z.im*O0*O0}); sZeros.push(r1,r2); }\r\n        for(let k=0;k<N;k++){ sZeros.push({re:0,im:O0},{re:0,im:-O0}); }\r\n        zPoles=sPoles.map(s=>BLT.sToZ(s,Fs)); zZeros=sZeros.map(s=>BLT.sToZ(s,Fs));\r\n      }\r\n    }\r\n\r\n    // SOS + gain normalization\r\n    const sections = SOS.fromZPK(zZeros, zPoles, 1);\r\n    let wRef=0;\r\n    if(kind==='highpass') wRef=Math.PI;\r\n    if(kind==='bandpass'){ const f0=Math.sqrt(f1*f2); wRef=2*Math.PI*(f0/Fs); }\r\n    const Href=Response.H_w_IIR(sections, wRef), g=1/(Math.hypot(Href.re,Href.im)||1e-12);\r\n    sections[0].b=[sections[0].b[0]*g, sections[0].b[1]*g, sections[0].b[2]*g];\r\n\r\n    return new IIRFilter({sections, Fs, zPoles, zZeros});\r\n  }\r\n}\r\n","// Main FilterDSP class\r\nimport { FIRDesigner } from \"./fir/FIRDesigner.js\";\r\nimport { IIRDesigner } from \"./iir/IIRDesigner.js\";\r\n\r\nexport class FilterDSP {\r\n  static designFIR(spec){ return new FIRDesigner(spec).design(); }\r\n  static designIIR(spec){ return new IIRDesigner(spec).design(); }\r\n}\r\n"],"names":["Cx","add","a","b","re","im","sub","mul","div","d","abs","Math","hypot","conj","TAU","PI","linspace","n","out","Array","i","unwrapPhase","phRad","pass","length","Poly","evalRealAsc","coeffs","z","res","evalMonicAndDeriv","coeffsMonic","N","p","dp","k","Roots","aberthMonic","raw","i0","cs","slice","a0","map","c","maxRatio","max","r0","min","roots","ang","jit","cos","sin","DEN_EPS","it","moved","zi","sumInv","j","dif","mag2","inv","denom","delta","ni","dkScaled","poly","monic","results","R","f","push","Prototypes","butter","poles","th","zeros","cheby1","Rp","eps","sqrt","pow","alpha","asinh","sinh","cosh","cheby2","Rs","eps2","M","floor","Oz","ellipHybrid","linkwitzRiley","evenN","base","forEach","pl","enforcedOrder","bessel","fill","nn","filter","r","BLT","prewarp","Fs","tan","sToZ","s","quad","b2","fourac","x","y","t","cSqrt","negb","twoa","pairConjs","arr","used","pairs","matched","SOS","fromZPK","zZeros","zPoles","gain","zp","pp","sections","pi","ppair","zpair","p1","p2","z1","z2","sumZ","prodZ","sumP","prodP","Response","H_w_IIR","w","acc","b0","b1","a1","a2","num","den","den2","h","H_w_FIR","taps","magDbFromH","H","log10","unwrapToDeg","v","groupDelay","phUnwrappedRad","gd","dphi","dw","phaseDelay","pd","NaN","firstFinite","find","Number","isFinite","Windows","rect","from","rectangle","hann","_","hamming","blackman","blackmanHarris","blackmanNuttall","kaiser","beta","_i0","tukey","gauss","sigma","m2","exp","bartlett","bartlettHann","cosine","lanczos","sinc","bohman","flatTop","nuttall","parzen","welch","triangular","poisson","hanning","vonHann","nuttallBlackmanHarris","exactBlackman","dolphChebyshev","acosh","chebyshev","acos","sum","m","taylor","nbar","sll","A","gaussian","raisedCosine","byName","name","opts","ax","t2","pushUnique","tol","q","FIRZeros","fromTapsRobust","cand","extra","want","K","picks","mags","Float64Array","approxUnitCircleMinima","enforceConjugates","FIRFilter","constructor","init","this","_zeros","type","impulseResponse","L","frequencyGrid","Nf","magdB","wi","atan2","phU","freqHz","phaseDeg","gdSamples","pdSamples","sincNorm","FIRDesigner","spec","design","kind","f1","f2","window","mid","w1","w2","win","lpAt","omega_c","hlp","h2","h1","wRef","f0","Href","g","IIRFilter","buf","v1","v2","yn","divC","IIRDesigner","family","proto","lr","order","Oc","sPoles","sZeros","includes","Error","O1","O2","B","O0","r1","r2","FilterDSP","designFIR","designIIR"],"mappings":"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"}