!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).DSPFilterLibrary={})}(this,function(t){"use strict";class e{static add(t,e){return{re:t.re+e.re,im:t.im+e.im}}static sub(t,e){return{re:t.re-e.re,im:t.im-e.im}}static mul(t,e){return{re:t.re*e.re-t.im*e.im,im:t.re*e.im+t.im*e.re}}static div(t,e){const r=e.re*e.re+e.im*e.im||1e-300;return{re:(t.re*e.re+t.im*e.im)/r,im:(t.im*e.re-t.re*e.im)/r}}static abs(t){return Math.hypot(t.re,t.im)}static conj(t){return{re:t.re,im:-t.im}}}const r=2*Math.PI;function s(t,e,r){const s=new Array(r),a=(e-t)/(r-1);for(let e=0;e<r;e++)s[e]=t+e*a;return s}function a(t){const e=[...t];for(let t=0;t<2;t++)for(let t=1;t<e.length;t++){const s=e[t]-e[t-1];s>Math.PI&&(e[t]-=r),s<-Math.PI&&(e[t]+=r)}return e}class n{static evalRealAsc(t,r){let s={re:t[0],im:0};for(let a=1;a<t.length;a++)s=e.add(e.mul(s,r),{re:t[a],im:0});return s}}function i(t,r){const s=t.length-1;let a={re:1,im:0},n={re:0,im:0};for(let i=1;i<=s;i++)n=e.add(e.mul(n,r),a),a=e.add(e.mul(a,r),{re:t[i],im:0});return{p:a,dp:n}}class o{static aberthMonic(t){let r=0;for(;r<t.length-1&&Math.abs(t[r])<1e-18;)r++;let s=t.slice(r);const a=s.length-1;if(a<=0)return[];const n=s[0];s=s.map(t=>t/n);let o=0;for(let t=1;t<s.length;t++)o=Math.max(o,Math.abs(s[t]));const c=Math.max(.5,Math.min(1.5,1+o)),h=new Array(a);for(let t=0;t<a;t++){const e=2*Math.PI*(t+.5)/a,r=1+.001*(t%2?1:-1);h[t]={re:c*r*Math.cos(e),im:c*r*Math.sin(e)}}const l=1e-14;for(let t=0;t<200;t++){let t=!1;for(let r=0;r<a;r++){const n=h[r],{p:o,dp:c}=i(s,n);let m={re:0,im:0};for(let t=0;t<a;t++)if(t!==r){let r=e.sub(n,h[t]);const s=r.re*r.re+r.im*r.im;s<1e-28&&(r={re:r.re+l,im:r.im});const a={re:r.re/(s||1e-300),im:-r.im/(s||1e-300)};m=e.add(m,a)}const u=e.sub(c,e.mul(o,m)),f=e.div(o,u),M=e.sub(n,f);Math.hypot(M.re-n.re,M.im-n.im)>1e-12&&(t=!0),h[r]=M}if(!t)break}return h}static dkScaled(t){let r=0;for(;r<t.length-1&&Math.abs(t[r])<1e-18;)r++;const s=t.slice(r),a=s.length-1;if(a<=0)return[];const i=s[0],o=s.map(t=>t/i),c=[];for(const t of[.8,1.1,1.5]){const r=new Array(a);for(let e=0;e<a;e++){const s=2*Math.PI*(e+1)/a;r[e]={re:t*Math.cos(s),im:t*Math.sin(s)}}for(let t=0;t<200;t++){let t=!1;for(let s=0;s<a;s++){let i={re:1,im:0};for(let t=0;t<a;t++)s!==t&&(i=e.mul(i,e.sub(r[s],r[t])));const c=n.evalRealAsc(o,r[s]),h=e.div(c,i),l=e.sub(r[s],h);Math.hypot(l.re-r[s].re,l.im-r[s].im)>1e-12&&(t=!0),r[s]=l}if(!t)break}c.push(...r)}return c}}class c{static butter(t){const e=[];for(let r=1;r<=t;r++){const s=(2*r-1)*Math.PI/(2*t);e.push({re:-Math.sin(s),im:Math.cos(s)})}return{poles:e,zeros:[]}}static cheby1(t,e){const r=Math.sqrt(Math.pow(10,e/10)-1),s=Math.asinh(1/r)/t,a=[];for(let e=1;e<=t;e++){const r=(2*e-1)*Math.PI/(2*t);a.push({re:-Math.sinh(s)*Math.sin(r),im:Math.cosh(s)*Math.cos(r)})}return{poles:a,zeros:[]}}static cheby2(t,e){const r=1/Math.sqrt(Math.pow(10,e/10)-1),s=Math.asinh(1/r)/t,a=[],n=[];for(let e=1;e<=t;e++){const r=(2*e-1)*Math.PI/(2*t);a.push({re:-Math.sinh(s)*Math.sin(r),im:Math.cosh(s)*Math.cos(r)})}const i=Math.floor(t/2);for(let e=1;e<=i;e++){const r=(2*e-1)*Math.PI/(2*t),s=1/Math.cos(r);n.push({re:0,im:s},{re:0,im:-s})}return{poles:a,zeros:n}}static ellipHybrid(t,e,r){const s=c.cheby1(t,e),a=c.cheby2(t,r);return{poles:s.poles,zeros:a.zeros}}static linkwitzRiley(t){const e=t%2==0?t:t+1,r=c.butter(e/2),s=[];return r.poles.forEach(t=>{s.push(t,{re:t.re,im:t.im})}),{poles:s,zeros:[],enforcedOrder:e}}static bessel(t){const e=Math.min(t,12),r=new Array(e+1).fill(0);r[0]=1;for(let t=1;t<=e;t++)r[t]=r[t-1]*((e+t)*(e-t+1))/(2*t);return{poles:(()=>{const t=r.length-1,e=new Array(t);for(let r=0;r<t;r++){const s=2*Math.PI*(r+1)/t;e[r]={re:1.5*Math.cos(s),im:1.5*Math.sin(s)}}for(let s=0;s<200;s++){let s=!1;for(let a=0;a<t;a++){let i={re:1,im:0};for(let r=0;r<t;r++)a!==r&&(i={re:i.re*(e[a].re-e[r].re)-i.im*(e[a].im-e[r].im),im:i.re*(e[a].im-e[r].im)+i.im*(e[a].re-e[r].re)});const o=n.evalRealAsc(r,e[a]),c={re:o.re/(i.re||1e-300),im:o.im/(i.re||1e-300)},h={re:e[a].re-c.re,im:e[a].im-c.im};Math.hypot(h.re-e[a].re,h.im-e[a].im)>1e-12&&(s=!0),e[a]=h}if(!s)break}return e.filter(t=>t.re<0||Math.abs(t.re)<1e-12)})(),zeros:[]}}}class h{static prewarp(t,e){return 2*e*Math.tan(Math.PI*t/e)}static sToZ(t,r){const s={re:2*r+t.re,im:t.im},a={re:2*r-t.re,im:-t.im};return e.div(s,a)}static quad(t,r,s){const a=e.mul(r,r),n=e.mul({re:4,im:0},e.mul(t,s)),i=function(t){const e=t.re,r=t.im,s=Math.hypot(e,r),a=Math.sqrt((s+Math.abs(e))/2);if(e>=0)return{re:a,im:r/(2*(a||1e-300))};const n=(r>=0?1:-1)*a;return{re:r/(2*(n||1e-300)),im:n}}({re:a.re-n.re,im:a.im-n.im}),o={re:-r.re,im:-r.im},c=e.mul({re:2,im:0},t);return[e.div(e.add(o,i),c),e.div(e.sub(o,i),c)]}}function l(t){const e=new Array(t.length).fill(!1),r=[];for(let s=0;s<t.length;s++){if(e[s])continue;const a=t[s];let n=!1;for(let i=s+1;i<t.length;i++)if(!e[i]){const o=t[i];if(Math.abs(a.re-o.re)<1e-10&&Math.abs(a.im+o.im)<1e-10){r.push([a,o]),e[s]=e[i]=!0,n=!0;break}}n||(r.push([a]),e[s]=!0)}return r}class m{static fromZPK(t,r,s=1){for(;t.length<r.length;)t.push({re:-1,im:0});const a=l(t),n=l(r),i=[];let o=0,c=0;for(;c<n.length;){const t=n[c++],r=o<a.length?a[o++]:[{re:-1,im:0},{re:-1,im:0}],s=t[0],h=t[1]||{re:0,im:0},l=r[0],m=r[1]||{re:-1,im:0},u={re:l.re+m.re,im:l.im+m.im},f=e.mul(l,m),M={re:s.re+h.re,im:s.im+h.im},p=e.mul(s,h),b=[1,-u.re,f.re],g=[1,-M.re,p.re];i.push({b:b,a:g})}return i.length&&(i[0].b=[i[0].b[0]*s,i[0].b[1]*s,i[0].b[2]*s]),i}}class u{static H_w_IIR(t,r){const s=Math.cos(r),a=-Math.sin(r),n=Math.cos(2*r),i=-Math.sin(2*r);let o={re:1,im:0};for(const r of t){const[t,c,h]=r.b,[,l,m]=r.a,u={re:t+c*s+h*n,im:c*a+h*i},f={re:1+l*s+m*n,im:l*a+m*i},M=f.re*f.re+f.im*f.im,p={re:(u.re*f.re+u.im*f.im)/M,im:(u.im*f.re-u.re*f.im)/M};o=e.mul(o,p)}return o}static H_w_FIR(t,e){let r=0,s=0;for(let a=0;a<t.length;a++)r+=t[a]*Math.cos(e*a),s-=t[a]*Math.sin(e*a);return{re:r,im:s}}static magDbFromH(t){return 20*Math.log10(Math.max(1e-16,e.abs(t)))}static unwrapToDeg(t){return a(t).map(t=>180*t/Math.PI)}static groupDelay(t,e){const r=e.length,s=new Array(r).fill(0);if(r>=3){for(let a=1;a<r-1;a++){const r=t[a+1]-t[a-1],n=e[a+1]-e[a-1];s[a]=-r/(n||1e-12)}s[0]=s[1],s[r-1]=s[r-2]}return s}static phaseDelay(t,e){const r=new Array(e.length).fill(0);for(let s=0;s<e.length;s++)r[s]=0===e[s]?NaN:-t[s]/e[s];let s=r.find(t=>Number.isFinite(t));Number.isFinite(s)||(s=0);for(let t=0;t<r.length&&!Number.isFinite(r[t]);t++)r[t]=s;for(let t=1;t<r.length;t++)Number.isFinite(r[t])||(r[t]=r[t-1]);return r}}class f{static rect(t){return Array.from({length:t},()=>1)}static rectangle(t){return f.rect(t)}static hann(t){return Array.from({length:t},(e,r)=>.5-.5*Math.cos(2*Math.PI*r/(t-1)))}static hamming(t){return Array.from({length:t},(e,r)=>.54-.46*Math.cos(2*Math.PI*r/(t-1)))}static blackman(t){return Array.from({length:t},(e,r)=>.42-.5*Math.cos(2*Math.PI*r/(t-1))+.08*Math.cos(4*Math.PI*r/(t-1)))}static blackmanHarris(t){return Array.from({length:t},(e,r)=>.35875-.48829*Math.cos(2*Math.PI*r/(t-1))+.14128*Math.cos(4*Math.PI*r/(t-1))-.01168*Math.cos(6*Math.PI*r/(t-1)))}static blackmanNuttall(t){return Array.from({length:t},(e,r)=>.3635819-.4891775*Math.cos(2*Math.PI*r/(t-1))+.1365995*Math.cos(4*Math.PI*r/(t-1))-.0106411*Math.cos(6*Math.PI*r/(t-1)))}static kaiser(t,e=8.6){const r=M(e),s=t-1;return Array.from({length:t},(t,a)=>{const n=2*a/s-1;return M(e*Math.sqrt(1-n*n))/r})}static tukey(t,e=.5){const r=t-1;return Array.from({length:t},(t,s)=>{const a=s/r;return e<=0?1:e>=1?.5*(1-Math.cos(2*Math.PI*a)):a<e/2?.5*(1+Math.cos(Math.PI*(2*a/e-1))):a<=1-e/2?1:.5*(1+Math.cos(Math.PI*(2*a/e-2/e+1)))})}static gauss(t,e=.4){const r=(t-1)/2;return Array.from({length:t},(t,s)=>{const a=(s-r)/(e*r);return Math.exp(-.5*a*a)})}static bartlett(t){const e=t-1;return Array.from({length:t},(t,r)=>1-Math.abs((r-e/2)/(e/2)))}static bartlettHann(t){const e=t-1;return Array.from({length:t},(t,r)=>{const s=r/e;return.62-.48*Math.abs(s-.5)-.38*Math.cos(2*Math.PI*s)})}static cosine(t){const e=t-1;return Array.from({length:t},(t,r)=>Math.sin(Math.PI*r/e))}static lanczos(t){const e=(t-1)/2;return Array.from({length:t},(t,r)=>{return 0===(s=(r-e)/e)?1:Math.sin(Math.PI*s)/(Math.PI*s);var s})}static bohman(t){const e=(t-1)/2;return Array.from({length:t},(t,r)=>{const s=Math.abs(r-e)/e;return s<=1?(1-s)*Math.cos(Math.PI*s)+1/Math.PI*Math.sin(Math.PI*s):0})}static flatTop(t){const e=t-1;return Array.from({length:t},(t,r)=>1-1.93*Math.cos(2*Math.PI*r/e)+1.29*Math.cos(4*Math.PI*r/e)-.388*Math.cos(6*Math.PI*r/e)+.028*Math.cos(8*Math.PI*r/e))}static nuttall(t){return Array.from({length:t},(e,r)=>.355768-.487396*Math.cos(2*Math.PI*r/(t-1))+.144232*Math.cos(4*Math.PI*r/(t-1))-.012604*Math.cos(6*Math.PI*r/(t-1)))}static parzen(t){const e=(t-1)/2;return Array.from({length:t},(t,r)=>{const s=Math.abs(r-e)/e;return s<=.5?1-6*s*s*(1-s):2*Math.pow(1-s,3)})}static welch(t){const e=t-1;return Array.from({length:t},(t,r)=>1-Math.pow((r-e/2)/(e/2),2))}static triangular(t){const e=t-1;return Array.from({length:t},(t,r)=>1-Math.abs((2*r-e)/e))}static poisson(t,e=2){const r=(t-1)/2;return Array.from({length:t},(t,s)=>Math.exp(-e*Math.abs(s-r)/r))}static hanning(t){return f.hann(t)}static vonHann(t){return f.hann(t)}static nuttallBlackmanHarris(t){return f.blackmanNuttall(t)}static exactBlackman(t){return Array.from({length:t},(e,r)=>.42659-.49656*Math.cos(2*Math.PI*r/(t-1))+.076849*Math.cos(4*Math.PI*r/(t-1)))}static dolphChebyshev(t,e=50){const r=t-1,s=Math.cosh(Math.acosh(Math.pow(10,e/20))/r),a=(t,e)=>Math.abs(e)<=1?Math.cos(t*Math.acos(e)):Math.cosh(t*Math.acosh(e)),n=new Array(t);for(let e=0;e<t;e++){let i=0;for(let n=0;n<t;n++){i+=a(r,s*Math.cos(Math.PI*n/t))*Math.cos(2*Math.PI*e*n/t)}n[e]=i/t}const i=Math.max(...n);return n.map(t=>t/i)}static taylor(t,e=4,r=-30){const s=(t-1)/2,a=Math.acosh(Math.pow(10,-r/20))/Math.PI;return Array.from({length:t},(t,r)=>{const n=(r-s)/s;let i=1;for(let t=1;t<e;t++){i+=2*Math.sqrt(1-t/(a*a+(t-.5)*(t-.5)))*Math.cos(2*Math.PI*t*n)}return i/(2*e-1)})}static gaussian(t,e=.4){return f.gauss(t,e)}static raisedCosine(t,e=.5){return f.tukey(t,e)}static byName(t,e,r={}){const{beta:s=8.6,alpha:a=.5,sigma:n=.4,nbar:i=4,sll:o=-30}=r||{};switch(t){case"hann":case"hanning":case"vonHann":return f.hann(e);case"hamming":default:return f.hamming(e);case"blackman":return f.blackman(e);case"blackmanHarris":return f.blackmanHarris(e);case"blackmanNuttall":case"nuttallBlackmanHarris":return f.blackmanNuttall(e);case"nuttall":return f.nuttall(e);case"exactBlackman":return f.exactBlackman(e);case"rectangle":case"rect":return f.rect(e);case"bartlett":return f.bartlett(e);case"bartlettHann":return f.bartlettHann(e);case"cosine":return f.cosine(e);case"lanczos":return f.lanczos(e);case"bohman":return f.bohman(e);case"gauss":case"gaussian":return f.gauss(e,n);case"tukey":case"raisedCosine":return f.tukey(e,a);case"kaiser":return f.kaiser(e,s);case"flatTop":case"flattop":return f.flatTop(e);case"parzen":return f.parzen(e);case"welch":return f.welch(e);case"triangular":return f.triangular(e);case"poisson":return f.poisson(e,a);case"dolphChebyshev":return f.dolphChebyshev(e,a);case"taylor":return f.taylor(e,i,o)}}}const M=t=>{const e=Math.abs(t);if(e<3.75){const e=t/3.75,r=e*e;return 1+r*(3.5156229+r*(3.0899424+r*(1.2067492+r*(.2659732+r*(.0360768+.0045813*r)))))}{const t=3.75/e;return Math.exp(e)/Math.sqrt(e)*(.39894228+t*(.01328592+t*(.00225319+t*(t*(.00916281+t*(t*(.02635537+t*(.00392377*t-.01647633))-.02057706))-.00157565))))}};function p(t,e,r=1e-9){for(const s of t)if(Math.hypot(s.re-e.re,s.im-e.im)<r)return!1;return t.push(e),!0}class b{static fromTapsRobust(t){const e=t.length-1,r=new Array(t.length);for(let s=0;s<t.length;s++)r[s]=t[e-s];let s=0;for(;s<r.length-1&&Math.abs(r[s])<1e-18;)s++;const a=r.slice(s).length-1;if(a<=0)return[];const n=[];try{for(const t of o.aberthMonic(r))Number.isFinite(t.re)&&Number.isFinite(t.im)&&p(n,t)}catch{}try{for(const t of o.dkScaled(r))Number.isFinite(t.re)&&Number.isFinite(t.im)&&p(n,t)}catch{}if(n.length<a){const e=function(t,e){const r=8192,s=[],a=new Float64Array(r+1);for(let e=0;e<=r;e++){const s=Math.PI*e/r,n=u.H_w_FIR(t,s);a[e]=Math.hypot(n.re,n.im)}for(let t=1;t<r;t++)if(a[t]<a[t-1]&&a[t]<a[t+1]){const a=Math.PI*t/r;if(s.push({re:Math.cos(a),im:Math.sin(a)}),s.length>=e)break}return s}(t,a-n.length);for(const t of e)p(n,t,1e-6)}const i=function(t,e=1e-9){const r=[];for(const s of t)p(r,s,e),Math.abs(s.im)>1e-12&&p(r,{re:s.re,im:-s.im},e);return r}(n),c=[];for(const t of i)if(p(c,t,1e-9)&&c.length===a)break;return c.length>a?c.slice(0,a):c}}class g{constructor(t){this.init=t,this._zeros=null}get type(){return"FIR"}get taps(){return this.init.taps}get Fs(){return this.init.Fs}impulseResponse(t=256){return this.taps.slice(0,t)}zeros(){return this._zeros||(this._zeros=b.fromTapsRobust(this.taps)),this._zeros}frequencyGrid(t=1024){const e=s(0,Math.PI,t),r=[],n=[];for(const t of e){const e=u.H_w_FIR(this.taps,t);r.push(u.magDbFromH(e)),n.push(Math.atan2(e.im,e.re))}const i=a(n),o=u.groupDelay(i,e),c=u.phaseDelay(i,e),h=e.map(t=>t/Math.PI*(this.Fs/2));return{w:e,freqHz:h,magdB:r,phaseDeg:i.map(t=>180*t/Math.PI),gdSamples:o,pdSamples:c}}}function y(t){return 0===t?1:Math.sin(Math.PI*t)/(Math.PI*t)}class I{constructor(t){this.spec=t}design(){const{kind:t,taps:e,Fs:r,f1:s,f2:a=s,window:n="hamming",beta:i=6}=this.spec,o=(e-1)/2,c=2*Math.PI*(s/r),h=2*Math.PI*(a/r),l=f.byName(n,e,i),m=new Array(e).fill(0),M=t=>{const r=new Array(e);for(let s=0;s<e;s++)r[s]=2*t/(2*Math.PI)*y((s-o)*t/Math.PI);return r};if("lowpass"===t){const t=M(c);for(let r=0;r<e;r++)m[r]=t[r]*l[r]}else if("highpass"===t){const t=M(c);for(let r=0;r<e;r++){const e=r===o?1:0;m[r]=(e-t[r])*l[r]}}else if("bandpass"===t){const t=M(h),r=M(c);for(let s=0;s<e;s++)m[s]=(t[s]-r[s])*l[s]}else{const t=M(h),r=M(c);for(let s=0;s<e;s++){const e=s===o?1:0;m[s]=(e-(t[s]-r[s]))*l[s]}}let p=0;if("highpass"===t&&(p=Math.PI),"bandpass"===t){const t=Math.sqrt(s*a);p=2*Math.PI*(t/r)}const b=u.H_w_FIR(m,p),I=1/(Math.hypot(b.re,b.im)||1e-12);for(let t=0;t<e;t++)m[t]*=I;return new g({taps:m,Fs:r})}}class d{constructor(t){this.init=t}get type(){return"IIR"}get sections(){return this.init.sections}get Fs(){return this.init.Fs}get zPoles(){return this.init.zPoles}get zZeros(){return this.init.zZeros}impulseResponse(t=256){const e=new Array(t).fill(0);e[0]=1;let r=e.slice();for(const e of this.sections){const[s,a,n]=e.b,[,i,o]=e.a,c=new Array(t).fill(0);let h=0,l=0;for(let e=0;e<t;e++){const t=r[e]-i*h-o*l,m=s*t+a*h+n*l;c[e]=m,l=h,h=t}r=c}return r}frequencyGrid(t=1024){const e=s(0,Math.PI,t),r=[],n=[];for(const t of e){const e=u.H_w_IIR(this.sections,t);r.push(u.magDbFromH(e)),n.push(Math.atan2(e.im,e.re))}const i=a(n),o=u.groupDelay(i,e),c=u.phaseDelay(i,e),h=e.map(t=>t/Math.PI*(this.Fs/2));return{w:e,freqHz:h,magdB:r,phaseDeg:i.map(t=>180*t/Math.PI),gdSamples:o,pdSamples:c}}}function P(t,e){const r=e.re*e.re+e.im*e.im||1e-300;return{re:(t.re*e.re+0*e.im)/r,im:(0*e.re-t.re*e.im)/r}}class w{constructor(t){this.spec=t}design(){const{family:t,kind:e,Fs:r}=this.spec;let{N:s,f1:a,f2:n}=this.spec;const i=this.spec.Rp??1,o=this.spec.Rs??60;let l;switch(t){case"butter":default:l=c.butter(s);break;case"cheby1":l=c.cheby1(s,i);break;case"cheby2":l=c.cheby2(s,o);break;case"ellip":l=c.ellipHybrid(s,i,o);break;case"linkwitz":{const t=c.linkwitzRiley(s);s=t.enforcedOrder??s,l={poles:t.poles,zeros:[]};break}case"bessel":l=c.bessel(s)}l.family=t,l.order=s;let f=[],M=[];if("lowpass"===e||"highpass"===e){const n=h.prewarp(a,r),i=l.poles.map(t=>"lowpass"===e?{re:t.re*n,im:t.im*n}:P({re:n},t)),o=l.zeros.map(t=>"lowpass"===e?{re:t.re*n,im:t.im*n}:P({re:n},t));if(f=i.map(t=>h.sToZ(t,r)),M=o.map(t=>h.sToZ(t,r)),["butter","cheby1","bessel","linkwitz"].includes(t)&&"highpass"===e)for(let t=0;t<s;t++)M.push({re:1,im:0})}else{if(!n)throw new Error("bandpass/bandstop require f2");if(n<a){const t=a;a=n,n=t}const i=h.prewarp(a,r),o=h.prewarp(n,r),c=o-i,m=Math.sqrt(i*o),u=[],p=[];if("bandpass"===e){for(const t of l.poles){const[e,r]=h.quad({re:1,im:0},{re:-t.re*c,im:-t.im*c},{re:m*m,im:0});u.push(e,r)}for(const t of l.zeros){const[e,r]=h.quad({re:1,im:0},{re:-t.re*c,im:-t.im*c},{re:m*m,im:0});p.push(e,r)}if(["butter","cheby1","bessel","linkwitz"].includes(t))for(let t=0;t<s;t++)p.push({re:0,im:0});if(f=u.map(t=>h.sToZ(t,r)),M=p.map(t=>h.sToZ(t,r)),["butter","cheby1","bessel","linkwitz"].includes(t))for(let t=0;t<s;t++)M.push({re:-1,im:0});else"cheby2"===t&&s%2==1&&M.push({re:1,im:0},{re:-1,im:0})}else{for(const t of l.poles){const[e,r]=h.quad({re:t.re,im:t.im},{re:-c,im:0},{re:t.re*m*m,im:t.im*m*m});u.push(e,r)}for(const t of l.zeros){const[e,r]=h.quad({re:t.re,im:t.im},{re:-c,im:0},{re:t.re*m*m,im:t.im*m*m});p.push(e,r)}for(let t=0;t<s;t++)p.push({re:0,im:m},{re:0,im:-m});f=u.map(t=>h.sToZ(t,r)),M=p.map(t=>h.sToZ(t,r))}}const p=m.fromZPK(M,f,1);let b=0;if("highpass"===e&&(b=Math.PI),"bandpass"===e){const t=Math.sqrt(a*n);b=2*Math.PI*(t/r)}const g=u.H_w_IIR(p,b),y=1/(Math.hypot(g.re,g.im)||1e-12);return p[0].b=[p[0].b[0]*y,p[0].b[1]*y,p[0].b[2]*y],new d({sections:p,Fs:r,zPoles:f,zZeros:M})}}t.BLT=h,t.Cx=e,t.FIRDesigner=I,t.FIRFilter=g,t.FIRZeros=b,t.FilterDSP=class{static designFIR(t){return new I(t).design()}static designIIR(t){return new w(t).design()}},t.IIRDesigner=w,t.IIRFilter=d,t.Poly=n,t.Prototypes=c,t.Response=u,t.Roots=o,t.SOS=m,t.TAU=r,t.Windows=f,t.linspace=s,t.unwrapPhase=a});
//# sourceMappingURL=dsp-filter-library.min.js.map
